# Copyright (c) 2023 Graphcore Ltd. All rights reserved.
# AUTOGENERATED from notebooks/binom_factor_table.ipynb

# fmt: off
# flake8: noqa
# isort: skip_file

from numpy import array,zeros

LMAX = 5
def get_monomials(a,b):
    return (1, a**2*b, a**4, a**2*b**4, b**4, a**3*b**2, a**4*b**2, a*b**4, a**3*b, a**3*b**3, a**2, a*b, a**4*b**3, b**2, a**4*b, a, a**3*b**4, a**4*b**4, a**2*b**2, a*b**2, b, b**3, a**3, a**2*b**3, a*b**3)

def build_binom_factor_table(sparse=False):
    inds,values = ((array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
       3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]), array([0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 0, 0, 1, 1, 1, 1, 2,
       2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 0, 0, 0,
       0, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3,
       3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
       4, 4, 4, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4,
       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4]), array([0, 0, 1, 0, 1, 2, 0, 1, 2, 3, 0, 1, 2, 3, 4, 0, 1, 0, 1, 1, 2, 0,
       1, 1, 2, 2, 3, 0, 1, 1, 2, 2, 3, 3, 4, 0, 1, 1, 2, 2, 3, 3, 4, 4,
       0, 1, 2, 0, 1, 1, 2, 2, 3, 0, 1, 1, 2, 2, 2, 3, 3, 4, 0, 1, 1, 2,
       2, 2, 3, 3, 3, 4, 4, 0, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 0, 1, 2,
       3, 0, 1, 1, 2, 2, 3, 3, 4, 0, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 0, 1,
       1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 4,
       4, 4, 4, 0, 1, 2, 3, 4, 0, 1, 1, 2, 2, 3, 3, 4, 4, 0, 1, 1, 2, 2,
       2, 3, 3, 3, 4, 4, 4, 0, 1, 1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 0,
       1, 1, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4]), array([ 0, 20,  0, 13, 20,  0, 21, 13, 20,  0,  4, 21, 13, 20,  0, 15,  0,
       11, 15, 20,  0, 19, 11, 13, 15, 20,  0, 24, 19, 21, 11, 13, 15, 20,
        0,  7,  4, 24, 19, 21, 11, 13, 15, 20, 10, 15,  0,  1, 10, 11, 15,
       20,  0, 18,  1, 19, 10, 11, 13, 15, 20,  0, 23, 18, 24,  1, 19, 21,
       10, 11, 13, 15, 20,  3,  7, 23,  4, 18, 24,  1, 19, 21, 10, 11, 13,
       22, 10, 15,  0,  8,  1, 22, 10, 11, 15, 20,  0,  5,  8, 18,  1, 19,
       22, 10, 11, 13, 15, 20,  9,  5, 23,  8, 18, 24,  1, 19, 21, 22, 10,
       11, 13, 16,  3,  9,  5,  7, 23,  4,  8, 18, 24,  1, 19, 21, 22,  2,
       22, 10, 15,  0, 14,  2,  8,  1, 22, 10, 11, 15, 20,  6,  5, 14,  2,
        8, 18,  1, 19, 22, 10, 11, 13, 12,  6,  9,  5, 14, 23,  2,  8, 18,
       24,  1, 19, 21, 22, 17, 12, 16,  3,  6,  9,  5,  7, 14, 23,  2,  4,
        8, 18, 24])), array([1, 1, 1, 1, 2, 1, 1, 3, 3, 1, 1, 4, 6, 4, 1, 1, 1, 1, 1, 1, 1, 1,
       2, 1, 1, 2, 1, 1, 3, 1, 3, 3, 1, 3, 1, 1, 1, 4, 6, 4, 4, 6, 1, 4,
       1, 2, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1, 4, 1, 2, 2, 1, 1, 3, 2, 3,
       6, 1, 1, 6, 3, 2, 3, 1, 2, 4, 1, 6, 8, 4, 12, 4, 1, 8, 6, 1, 3, 3,
       1, 1, 3, 1, 3, 3, 3, 1, 1, 1, 2, 3, 6, 3, 1, 3, 6, 1, 3, 2, 1, 3,
       3, 3, 9, 3, 9, 9, 1, 1, 3, 9, 3, 1, 3, 4, 6, 3, 12, 1, 4, 18, 12,
       12, 18, 4, 1, 1, 4, 6, 4, 1, 1, 1, 4, 6, 4, 6, 4, 4, 1, 1, 4, 2, 1,
       8, 6, 12, 4, 4, 6, 8, 1, 1, 3, 4, 12, 3, 6, 1, 12, 18, 4, 18, 12,
       1, 4, 1, 4, 4, 6, 6, 16, 24, 4, 4, 24, 1, 1, 16, 36, 16]))
    if sparse:
      return inds,values
    else:
      W = zeros((LMAX,LMAX,LMAX,LMAX*LMAX))
      W[inds] = values
      return W
